# ASP LMS - Учебная платформа для агентства недвижимости

Локальная демо-версия учебной платформы с поддержкой двух ролей: ученик (кандидат) и HR (администратор).

## Технологии

- **Next.js 14** (App Router) с TypeScript
- **Prisma** с SQLite для локального хранения данных
- **Tailwind CSS** для стилизации
- **JWT** для аутентификации через cookies

## Быстрый старт

### 1. Установка зависимостей

```bash
npm install
```

### 2. Настройка базы данных

```bash
# Создание миграций и базы данных
npx prisma migrate dev

# Заполнение базы тестовыми данными
npm run db:seed
```

### 3. Запуск приложения

```bash
npm run dev
```

Приложение будет доступно по адресу: http://localhost:3000

## Демо-аккаунты

### Ученик (STUDENT)
- **Логин:** `user`
- **Пароль:** `user`

### HR (Администратор)
- **Логин:** `hr`
- **Пароль:** `hr`

## Функционал

### Для ученика (STUDENT)

1. **Дашборд** (`/student`)
   - Просмотр текущего статуса
   - Выбор активного курса из списка доступных
   - Просмотр баллов и статуса офера

2. **Прохождение курса** (`/student/course`)
   - Просмотр списка уроков
   - Изучение уроков по порядку
   - Переход к тесту после изучения всех уроков

3. **Тест** (`/student/quiz`)
   - Прохождение итогового теста курса
   - 10 вопросов с 4 вариантами ответов каждый
   - Автоматический подсчёт баллов

4. **Результаты** (`/student/result`)
   - Просмотр набранных баллов
   - Статус по результатам теста:
     - 0-49 баллов → Отказ (REJECTED)
     - 50-74 балла → Офер стажёр (OFFER_TRAINEE)
     - 75-100 баллов → Офер риэлтор (OFFER_REALTOR)
   - Принятие или отклонение офера

### Для HR

1. **Воронка обучения** (`/hr`)
   - Карточный дашборд с количеством кандидатов по статусам
   - Список всех кандидатов с фильтрацией
   - Детальная информация по каждому кандидату

2. **Управление кандидатами** (`/hr/users`)
   - Просмотр списка всех кандидатов
   - Детальная информация о каждом кандидате
   - История прохождения тестов

3. **Управление курсами** (`/hr/courses`)
   - Просмотр всех курсов
   - Детальная информация о курсе (уроки, тест)
   - Создание нового курса

4. **Создание курса** (`/hr/courses/new`)
   - Многошаговая форма:
     1. Информация о курсе (название, описание)
     2. Добавление уроков (неограниченное количество)
     3. Создание теста с вопросами

## Структура базы данных

### Основные модели

- **User** - пользователи (ученики и HR)
- **Course** - курсы
- **Lesson** - уроки курса
- **Quiz** - тесты курса
- **Question** - вопросы теста
- **Attempt** - попытки прохождения теста

## Логика оценивания

- Каждый вопрос имеет вес (по умолчанию 10 баллов)
- Максимальный балл: 100
- Итоговый балл = сумма весов правильных ответов (но не более 100)

### Статусы после теста

- **REJECTED** - балл < 50
- **OFFER_TRAINEE** - балл 50-74
- **OFFER_REALTOR** - балл 75-100

## Базовый курс

В seed данных создаётся один готовый курс:
- **Название:** "Основы работы риэлтора в агентстве недвижимости"
- **5 уроков** по темам:
  1. Роль риэлтора в агентстве и базовая этика
  2. Воронка работы с клиентом: от лида до сделки
  3. Основы работы с объектами недвижимости
  4. Коммуникация с клиентом
  5. Дисциплина, отчётность и работа в CRM
- **Тест:** 10 вопросов по содержанию уроков

## Разработка

### Просмотр базы данных

```bash
npx prisma studio
```

### Сброс базы данных

```bash
# Удалить базу и создать заново
rm prisma/dev.db
npx prisma migrate dev
npm run db:seed
```

## Примечания

- Все данные хранятся локально в SQLite
- Аутентификация через JWT в httpOnly cookies
- Пароли хешируются с помощью bcrypt
- Приложение полностью работает без внешних сервисов

